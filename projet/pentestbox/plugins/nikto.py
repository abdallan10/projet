import subprocess
from pentestbox.plugins.base import PluginBase

class NiktoPlugin(PluginBase):
    def name(self) -> str:
        return "nikto"

    def scan(self, target: str, options: dict, output_file: str, celery_task=None) -> dict:
        cmd = [
            "nikto",
            "-h", str(target),
            "-output", output_file,
            "-Format", "json"
        ]
        # Extend with options if needed
        subprocess.run(cmd, check=True)
        # Could parse JSON here if needed
        return {"result_file": output_file}

    @classmethod
    def is_available(cls):
        try:
            subprocess.run(["nikto", "-Version"], capture_output=True)
            return True
        except Exception:
            return False